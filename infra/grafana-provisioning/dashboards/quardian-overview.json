{
  "annotations": { "list": [{ "builtIn": 1, "type": "dashboard" }] },
  "editable": true,
  "title": "Quardian Quantum Security Dashboard",
  "style": "dark",
  "schemaVersion": 39,
  "refresh": "10s",
  "panels": [
    {
      "type": "row",
      "title": "PQC API Summary",
      "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Encrypt Calls",
      "gridPos": { "x": 0, "y": 1, "w": 6, "h": 4 },
      "targets": [{ "expr": "sum(quardian_encrypt_total)" }],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{ "color": "dark-green" }, { "color": "green" }] },
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "Decrypt Calls",
      "gridPos": { "x": 6, "y": 1, "w": 6, "h": 4 },
      "targets": [{ "expr": "sum(quardian_decrypt_total)" }]
    },
    {
      "type": "stat",
      "title": "Verify Calls",
      "gridPos": { "x": 12, "y": 1, "w": 6, "h": 4 },
      "targets": [{ "expr": "sum(quardian_verify_total)" }]
    },
    {
      "type": "gauge",
      "title": "API Uptime %",
      "gridPos": { "x": 18, "y": 1, "w": 6, "h": 4 },
      "targets": [{ "expr": "up{job='quardian-backend'}" }],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 1,
          "unit": "percentunit",
          "color": { "mode": "thresholds" },
          "thresholds": {
            "steps": [
              { "value": 0, "color": "red" },
              { "value": 0.95, "color": "green" }
            ]
          }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "PQC API Latency (p95)",
      "gridPos": { "x": 0, "y": 5, "w": 12, "h": 7 },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[2m])) by (le, handler))",
          "legendFormat": "{{handler}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "PQC vs Classical Latency Trend",
      "gridPos": { "x": 12, "y": 5, "w": 12, "h": 7 },
      "targets": [
        { "expr": "sum(rate(quardian_encrypt_total[2m]))", "legendFormat": "PQC Encrypt" },
        { "expr": "sum(rate(quardian_decrypt_total[2m]))", "legendFormat": "PQC Decrypt" },
        { "expr": "sum(rate(quardian_verify_total[2m]))", "legendFormat": "PQC Verify" }
      ]
    },
    {
      "type": "gauge",
      "title": "PQC Efficiency",
      "gridPos": { "x": 0, "y": 12, "w": 6, "h": 5 },
      "targets": [{ "expr": "(sum(quardian_encrypt_total) / (sum(quardian_encrypt_total) + sum(quardian_verify_total)))" }],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 1,
          "unit": "percentunit",
          "thresholds": {
            "steps": [
              { "value": 0, "color": "red" },
              { "value": 0.7, "color": "orange" },
              { "value": 0.9, "color": "green" }
            ]
          }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Backend CPU Usage (%)",
      "gridPos": { "x": 6, "y": 12, "w": 9, "h": 5 },
      "targets": [{ "expr": "process_cpu_seconds_total", "legendFormat": "CPU seconds" }]
    },
    {
      "type": "timeseries",
      "title": "Memory Usage (MB)",
      "gridPos": { "x": 15, "y": 12, "w": 9, "h": 5 },
      "targets": [{ "expr": "process_resident_memory_bytes/1024/1024", "legendFormat": "Memory (MB)" }]
    },
    {
      "type": "heatmap",
      "title": "Request Duration Heatmap",
      "gridPos": { "x": 0, "y": 17, "w": 12, "h": 6 },
      "targets": [{ "expr": "sum(rate(http_request_duration_seconds_bucket[1m])) by (le)" }]
    },
    {
  "type": "gauge",
  "title": "API Latency (p95)",
  "gridPos": { "x": 12, "y": 17, "w": 12, "h": 6 },
  "targets": [
    {
      "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[2m])) by (le))",
      "legendFormat": "p95 latency"
    }
  ],
  "fieldConfig": {
    "defaults": {
      "unit": "s",
      "min": 0,
      "max": 0.1,
      "color": { "mode": "thresholds" },
      "thresholds": {
        "mode": "absolute",
        "steps": [
          { "value": 0, "color": "green" },
          { "value": 0.05, "color": "orange" },
          { "value": 0.1, "color": "red" }
        ]
      }
    }
  },
  "options": {
    "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
    "showThresholdLabels": true,
    "showThresholdMarkers": true,
    "orientation": "horizontal"
  }
    }

  ],
  "version": 3
}
